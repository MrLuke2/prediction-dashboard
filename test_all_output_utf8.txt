
> agent-predict-war-room@0.1.0 test
> vitest


[1m[44m DEV [49m[22m [34mv4.0.18 [39m[90mC:/Users/mrnlu/repos/agent-predict-war-room-backend-research-docs[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould connect with correct URL including token
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

node.exe : [90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould connect with correct URL 
including token
At C:\Program Files\nodejs\npm.ps1:29 
char:3
+   & $NODE_EXE $NPM_CLI_JS $args
+   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecifie 
   d: ([90mstderr[2m...including token  
  :String) [], RemoteException
    + FullyQualifiedErrorId : NativeComma 
   ndError
 
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:42:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould transition to connected state on open
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould transition to connected 
state on open
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:48:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould send PING every 30s
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)
[WS] Reconnecting in 2000ms (attempt 2)
[WS] Reconnecting in 4000ms (attempt 3)
[WS] Reconnecting in 8000ms (attempt 4)
[WS] Reconnecting in 16000ms (attempt 5)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould send PING every 30s
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:55:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:59:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:59:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:59:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:59:8

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould disconnect on missing PONG
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)
[WS] Reconnecting in 2000ms (attempt 2)
[WS] Reconnecting in 4000ms (attempt 3)
[WS] Reconnecting in 8000ms (attempt 4)
[WS] Reconnecting in 16000ms (attempt 5)
[WS] Reconnecting in 30000ms (attempt 6)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould disconnect on missing PONG
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:64:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:68:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:68:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:68:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:68:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould reconnect after disconnect with backoff
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:69:8

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould reconnect after 
disconnect with backoff
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:76:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould cap backoff at 30s
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould cap backoff at 30s
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)
[WS] Reconnecting in 2000ms (attempt 2)
[WS] Reconnecting in 4000ms (attempt 3)
[WS] Reconnecting in 8000ms (attempt 4)
[WS] Reconnecting in 16000ms (attempt 5)
[WS] Reconnecting in 30000ms (attempt 6)
[WS] Reconnecting in 30000ms (attempt 7)
[WS] Reconnecting in 30000ms (attempt 8)
[WS] Reconnecting in 30000ms (attempt 9)
[WS] Reconnecting in 30000ms (attempt 10)
[WS] Reconnecting in 30000ms (attempt 11)
[WS] Reconnecting in 30000ms (attempt 12)

[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:98:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:116:8

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould discard malformed message without throwing
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould discard malformed message 
without throwing
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:121:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

 [31mΓ¥»[39m src/test/unit/websocket.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 158[2mms[22m[39m
     [32mΓ£ô[39m should connect with correct URL including token[32m 28[2mms[22m[39m
[31m     [31m├ù[31m should transition to connected state on open[39m[32m 18[2mms[22m[39m
[31m     [31m├ù[31m should send PING every 30s[39m[32m 41[2mms[22m[39m
[31m     [31m├ù[31m should disconnect on missing PONG[39m[32m 22[2mms[22m[39m
[31m     [31m├ù[31m should reconnect after disconnect with backoff[39m[32m 6[2mms[22m[39m
     [32mΓ£ô[39m should cap backoff at 30s[32m 27[2mms[22m[39m
     [32mΓ£ô[39m should discard malformed message without throwing[32m 9[2mms[22m[39m
 [32mΓ£ô[39m src/test/integration/notifications.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 391[2mms[22m[39m
 [31mΓ¥»[39m src/test/integration/aiProviderSelector.test.tsx [2m([22m[2m5 tests[22m[2m | [22m[31m5 failed[39m[2m)[22m[32m 22[2mms[22m[39m
[31m     [31m├ù[31m renders in compact mode by default[39m[32m 10[2mms[22m[39m
[31m     [31m├ù[31m opens panel and shows all 3 providers[39m[32m 2[2mms[22m[39m
[31m     [31m├ù[31m updates store and fires toast when selecting Gemini[39m[32m 2[2mms[22m[39m
[31m     [31m├ù[31m allows model selection per provider[39m[32m 1[2mms[22m[39m
[31m     [31m├ù[31m persists selection to localStorage[39m[32m 1[2mms[22m[39m
 [32mΓ£ô[39m src/test/unit/aiProvider.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 407[2mms[22m[39m
 [32mΓ£ô[39m src/test/integration/widgetSwap.test.tsx [2m([22m[2m2 tests[22m[2m)[22m[33m 688[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m restores DEFAULT_LAYOUT when clicking reset [33m 675[2mms[22m[39m
 [32mΓ£ô[39m src/test/integration/auth.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 3706[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m calls authApi.login and updates store on success [33m 1621[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m shows error message on 401/failure [33m 1029[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m renders password strength bar on register tab [33m 782[2mms[22m[39m
[90mstderr[2m | src/test/integration/alp
haGauge.test.tsx[2m > 
[22m[2mAlphaGauge Integration[2m > 
[22m[2mshows skeleton when alphaMetric 
is null
[22m[39m[Perf] SLOW RENDER: <AlphaGauge 
/> took 25.35ms

[90mstderr[2m | 
src/test/unit/utils.test.tsx[2m > 
[22m[2mUtility Functions[2m > 
[22m[2mPerformance Monitoring[2m > 
[22m[2mshould wrap component with 
measureRender
[22m[39m[Perf] SLOW RENDER: 
<TestComponent /> took 16.34ms

 [32mΓ£ô[39m src/test/unit/utils.test.tsx [2m([22m[2m7 tests[22m[2m)[22m[32m 165[2mms[22m[39m
 [32mΓ£ô[39m src/test/unit/stores.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 40[2mms[22m[39m
[90mstderr[2m | src/test/integration/alp
haGauge.test.tsx[2m > 
[22m[2mAlphaGauge Integration[2m > 
[22m[2mshows value and regime label 
when data is present
[22m[39m[Perf] SLOW RENDER: <AlphaGauge 
/> took 71.54ms

 [32mΓ£ô[39m src/test/integration/alphaGauge.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[33m 325[2mms[22m[39m
 [32mΓ£ô[39m src/lib/__tests__/utils.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 29[2mms[22m[39m
 [32mΓ£ô[39m src/components/layout/Header/__tests__/MarketSearchBasic.test.tsx [2m([22m[2m2 tests[22m[2m)[22m[32m 172[2mms[22m[39m
 [32mΓ£ô[39m src/store/__tests__/useUIStore.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 19[2mms[22m[39m
 [32mΓ£ô[39m src/store/__tests__/useLayoutStore.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 15[2mms[22m[39m
 [32mΓ£ô[39m src/store/__tests__/market_trade.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 17[2mms[22m[39m
 [32mΓ£ô[39m src/components/widgets/__tests__/registry.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 13[2mms[22m[39m
 [2m[90mΓåô[39m[22m src/components/layout/Header/__tests__/MarketSearch.test.tsx [2m([22m[2m3 tests[22m[2m | [22m[33m3 skipped[39m[2m)[22m

[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m[1m[41m 
Failed Tests 9 
[49m[22m[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m

[41m[1m FAIL [22m[49m src/test/integra
tion/aiProviderSelector.test.tsx[2m > 
[22mAIProviderSelector Integration[2m > 
[22mrenders in compact mode by default
[41m[1m FAIL [22m[49m src/test/integra
tion/aiProviderSelector.test.tsx[2m > 
[22mAIProviderSelector Integration[2m > 
[22mopens panel and shows all 3 providers
[41m[1m FAIL [22m[49m src/test/integra
tion/aiProviderSelector.test.tsx[2m > 
[22mAIProviderSelector Integration[2m > 
[22mupdates store and fires toast when 
selecting Gemini
[41m[1m FAIL [22m[49m src/test/integra
tion/aiProviderSelector.test.tsx[2m > 
[22mAIProviderSelector Integration[2m > 
[22mallows model selection per provider
[41m[1m FAIL [22m[49m src/test/integra
tion/aiProviderSelector.test.tsx[2m > 
[22mAIProviderSelector Integration[2m > 
[22mpersists selection to localStorage
[31m[1mReferenceError[22m: cleanup is 
not defined[39m
[36m [2mΓ¥»[22m src/test/integration/ai
ProviderSelector.test.tsx:[2m12:5[22m[3
9m
    [90m 10| [39m[34mdescribe[39m([32
m'AIProviderSelector 
Integration'[39m[33m,[39m () 
[33m=>[39m {
    [90m 11| [39m  
[34mbeforeEach[39m(() [33m=>[39m {
    [90m 12| [39m    
[34mcleanup[39m()[33m;[39m
    [90m   | [39m    [31m^[39m
    [90m 13| [39m    
[34mresetAllStores[39m()[33m;[39m
    [90m 14| [39m    vi[33m.[39m[34mc
learAllMocks[39m()[33m;[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[1/
9]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
transition to connected state on open
[31m[1mAssertionError[22m: expected 
"vi.fn()" to be called with arguments: [ 
'connected' ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[32m-   "connected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  2nd vi.fn() call:

[22m[2m  [[22m
[32m-   "connected",[90m
[31m+   "error",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m2[22m
[31m[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m51:27[22m[39m
    [90m 49| [39m    [35mconst[39m 
socket [33m=[39m 
[34mgetSocket[39m()[33m;[39m
    [90m 50| [39m    [35mif[39m 
(socket[33m.[39monopen) socket[33m.[39
m[34monopen[39m()[33m;[39m
    [90m 51| [39m    [34mexpect[39m(on
StateChange)[33m.[39m[34mtoHaveBeenCall
edWith[39m([32m'connected'[39m)[33m;[
39m
    [90m   | [39m                       
   [31m^[39m
    [90m 52| [39m  })[33m;[39m
    [90m 53| [39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[2/
9]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
send PING every 30s
[31m[1mTypeError[22m: undefined is not 
a spy or a call to a spy![39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m60:25[22m[39m
    [90m 58| [39m    
    [90m 59| [39m    vi[33m.[39m[34ma
dvanceTimersByTime[39m([34m30000[39m)[
33m;[39m
    [90m 60| [39m    expect(socket.send)
.toHaveBeenCalledWith(expect.stringContain
ing('ΓÇª
    [90m   | [39m                       
 [31m^[39m
    [90m 61| [39m  })[33m;[39m
    [90m 62| [39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[3/
9]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
disconnect on missing PONG
[31m[1mAssertionError[22m: expected 
"vi.fn()" to be called with arguments: [ 
'disconnected' ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  2nd vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  3rd vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  4th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  5th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  6th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  7th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  8th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  9th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  10th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  11th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  12th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m12[22m
[31m[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m71:27[22m[39m
    [90m 69| [39m    vi[33m.[39m[34ma
dvanceTimersByTime[39m([34m11000[39m)[
33m;[39m [90m// Wait for PONG timeout 
(10s)[39m
    [90m 70| [39m    
    [90m 71| [39m    [34mexpect[39m(on
StateChange)[33m.[39m[34mtoHaveBeenCall
edWith[39m([32m'disconnected'[39m)[33m
;[39m
    [90m   | [39m                       
   [31m^[39m
    [90m 72| [39m    [34mexpect[39m(so
cket[33m.[39mclose)[33m.[39m[34mtoHav
eBeenCalled[39m()[33m;[39m
    [90m 73| [39m  })[33m;[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[4/
9]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
reconnect after disconnect with backoff
[31m[1mAssertionError[22m: expected 
"vi.fn()" to be called with arguments: [ 
'disconnected' ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  2nd vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m2[22m
[31m[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m81:27[22m[39m
    [90m 79| [39m    [35mif[39m 
(socket1[33m.[39monclose) socket1[33m.
[39m[34monclose[39m()[33m;[39m
    [90m 80| [39m    
    [90m 81| [39m    [34mexpect[39m(on
StateChange)[33m.[39m[34mtoHaveBeenCall
edWith[39m([32m'disconnected'[39m)[33m
;[39m
    [90m   | [39m                       
   [31m^[39m
    [90m 82| [39m    
    [90m 83| [39m    [90m// First 
reconnect attempt after 1000ms[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[5/
9]ΓÄ»[22m[39m


[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m13 passed[39m[22m[2m | [22m[33m1 skipped[39m[90m (16)[39m
[2m      Tests [22m [1m[31m9 failed[39m[22m[2m | [22m[1m[32m57 passed[39m[22m[2m | [22m[33m3 skipped[39m[90m (69)[39m
[2m   Start at [22m 10:58:57
[2m   Duration [22m 19.14s[2m (transform 2.12s, setup 12.52s, import 10.18s, tests 6.17s, environment 62.38s)[22m

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/test/integration/aiProviderSelector.test.tsx [22m[34mx1 [34m[39m

 [31mΓ¥»[39m src/test/unit/websocket.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 158[2mms[22m[39m
     [32mΓ£ô[39m should connect with correct URL including token[32m 28[2mms[22m[39m
[31m     [31m├ù[31m should transition to connected state on open[39m[32m 18[2mms[22m[39m
[31m     [31m├ù[31m should send PING every 30s[39m[32m 41[2mms[22m[39m
[31m     [31m├ù[31m should disconnect on missing PONG[39m[32m 22[2mms[22m[39m
[31m     [31m├ù[31m should reconnect after disconnect with backoff[39m[32m 6[2mms[22m[39m
     [32mΓ£ô[39m should cap backoff at 30s[32m 27[2mms[22m[39m
     [32mΓ£ô[39m should discard malformed message without throwing[32m 9[2mms[22m[39m
 [31mΓ¥»[39m src/test/integration/aiProviderSelector.test.tsx [2m([22m[2m5 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 1595[2mms[22m[39m
     [32mΓ£ô[39m renders in compact mode by default[32m 126[2mms[22m[39m
[31m     [31m├ù[31m opens panel and shows all 3 providers[39m[33m 399[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m updates store and fires toast when selecting Gemini [33m 382[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m allows model selection per provider [33m 482[2mms[22m[39m
     [32mΓ£ô[39m persists selection to localStorage[32m 202[2mms[22m[39m

[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m[1m[41m 
Failed Tests 1 
[49m[22m[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m

[41m[1m FAIL [22m[49m src/test/integra
tion/aiProviderSelector.test.tsx[2m > 
[22mAIProviderSelector Integration[2m > 
[22mopens panel and shows all 3 providers
[31m[1mTestingLibraryElementError[22m[
39m: Found multiple elements with the 
text: Claude

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<span[39m
  [33mclass[39m=[32m"text-[10px] 
font-bold text-white uppercase 
tracking-tight"[39m
[36m>[39m
  [0mClaude[0m
  [0m [0m
  [36m<span[39m
    [33mclass[39m=[32m"text-text-muted 
font-normal ml-1"[39m
  [36m>[39m
    [0m/ [0m
    [0mclaude-sonnet-4-5[0m
  [36m</span>[39m
[36m</span>[39m

Ignored nodes: comments, script, style
[36m<p[39m
  [33mclass[39m=[32m"text-xs font-bold 
text-white tracking-tight"[39m
[36m>[39m
  [0mClaude[0m
[36m</p>[39m

(If this is intentional, then use the 
`*AllBy*` variant of the query (like 
`queryAllByText`, `getAllByText`, or 
`findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"relative"[39m
    [36m>[39m
      [36m<button[39m
        [33mclass[39m=[32m"flex 
items-center space-x-2 px-3 py-1.5 
rounded-full bg-zinc-900 border 
border-fin-border hover:border-zinc-600 
transition-colors"[39m
        [33mdata-testid[39m=[32m"ai-pro
vider-selector-trigger"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"w-2 h-2 
rounded-full shadow-[0_0_8px_rgba(var(--co
lor-primary-rgb),0.5)]"[39m
          
[33mstyle[39m=[32m"background-color: 
rgb(217, 119, 6);"[39m
        [36m/>[39m
        [36m<span[39m
          
[33mclass[39m=[32m"text-[10px] 
font-bold text-white uppercase 
tracking-tight"[39m
        [36m>[39m
          [0mClaude[0m
          [0m [0m
          [36m<span[39m
            
[33mclass[39m=[32m"text-text-muted 
font-normal ml-1"[39m
          [36m>[39m
            [0m/ [0m
            [0mclaude-sonnet-4-5[0m
          [36m</span>[39m
        [36m</span>[39m
        [36m<svg[39m
          [33mclass[39m=[32m"lucide 
lucide-chevron-down text-text-muted 
transition-transform rotate-180"[39m
          [33mfill[39m=[32m"none"[39m
          [33mheight[39m=[32m"12"[39m
          
[33mstroke[39m=[32m"currentColor"[39m
          
[33mstroke-linecap[39m=[32m"round"[39m
          [33mstroke-linejoin[39m=[32m"
round"[39m
          
[33mstroke-width[39m=[32m"2"[39m
          [33mviewBox[39m=[32m"0 0 24 
24"[39m
          [33mwidth[39m=[32m"12"[39m
          [33mxmlns[39m=[32m"http://www
.w3.org/2000/svg"[39m
        [36m>[39m
          [36m<path[39m
            [33md[39m=[32m"m6 9 6 6 
6-6"[39m
          [36m/>[39m
        [36m</svg>[39m
      [36m</button>[39m
      [36m<div[39m
        [33mclass[39m=[32m"absolute 
top-full right-0 mt-2 w-64 bg-zinc-950 
border border-fin-border rounded-xl 
shadow-2xl z-[100] overflow-hidden"[39m
        [33mstyle[39m=[32m"opacity: 0; 
transform: translateY(10px) 
scale(0.95);"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"p-2 
space-y-1"[39m
        [36m>[39m
          [36m<div[39m
            
[33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<button[39m
              
[33mclass[39m=[32m"w-full flex 
items-center justify-between p-2 
rounded-lg transition-all group 
bg-zinc-900 ring-1 ring-inset"[39m
              
[33mstyle[39m=[32m"border-color: 
rgb(217, 119, 6);"[39m
            [36m>[39m
              [36m<div[39m
                
[33mclass[39m=[32m"flex items-center 
space-x-3"[39m
              [36m>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"p-1.5 rounded-md 
bg-zinc-800 text-text-muted 
group-hover:text-white 
transition-colors"[39m
                  
[33mstyle[39m=[32m"color: rgb(217, 
119, 6);"[39m
                [36m>[39m
                  [36m<svg[39m
                    
[33mclass[39m=[32m"lucide 
lucide-bot"[39m
                    
[33mfill[39m=[32m"none"[39m
                    
[33mheight[39m=[32m"16"[39m
                    
[33mstroke[39m=[32m"currentColor"[39m
                    
[33mstroke-linecap[39m=[32m"round"[39m
                    [33mstroke-linejoin[
39m=[32m"round"[39m
                    
[33mstroke-width[39m=[32m"2"[39m
                    
[33mviewBox[39m=[32m"0 0 24 24"[39m
                    
[33mwidth[39m=[32m"16"[39m
                    [33mxmlns[39m=[32m"
http://www.w3.org/2000/svg"[39m
                  [36m>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M12 8V4H8"[39m
                    [36m/>[39m
                    [36m<rect[39m
                      
[33mheight[39m=[32m"12"[39m
                      
[33mrx[39m=[32m"2"[39m
                      
[33mwidth[39m=[32m"16"[39m
                      
[33mx[39m=[32m"4"[39m
                      
[33my[39m=[32m"8"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M2 14h2"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M20 14h2"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M15 13v2"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M9 13v2"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</div>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"text-left"[39m
                [36m>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-xs font-bold 
text-white tracking-tight"[39m
                  [36m>[39m
                    [0mClaude[0m
                  [36m</p>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-[10px] 
text-text-muted line-clamp-1"[39m
                  [36m>[39m
                    [0mAnthropic Claude 
ΓÇö Best for nuanced analysis[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<svg[39m
                
[33mclass[39m=[32m"lucide 
lucide-check"[39m
                
[33mfill[39m=[32m"none"[39m
                
[33mheight[39m=[32m"14"[39m
                
[33mstroke[39m=[32m"currentColor"[39m
                
[33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=
[32m"round"[39m
                
[33mstroke-width[39m=[32m"2"[39m
                
[33mstyle[39m=[32m"color: rgb(217, 
119, 6);"[39m
                [33mviewBox[39m=[32m"0 
0 24 24"[39m
                
[33mwidth[39m=[32m"14"[39m
                [33mxmlns[39m=[32m"http
://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 6 
9 17l-5-5"[39m
                [36m/>[39m
              [36m</svg>[39m
            [36m</button>[39m
            [36m<div[39m
              [33mclass[39m=[32m"ml-10 
pr-2 pb-2"[39m
            [36m>[39m
              [36m<select[39m
                
[33mclass[39m=[32m"w-full bg-zinc-900 
border border-zinc-800 text-[10px] 
text-zinc-300 rounded px-2 py-1 
focus:outline-none 
focus:border-zinc-600"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"cl
aude-opus-4-5"[39m
                [36m>[39m
                  [0mclaude-opus-4-5[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"cl
aude-sonnet-4-5"[39m
                [36m>[39m
                  
[0mclaude-sonnet-4-5[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"cl
aude-haiku-4-5"[39m
                [36m>[39m
                  [0mclaude-haiku-4-5[0m
                [36m</option>[39m
              [36m</select>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            
[33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<button[39m
              
[33mclass[39m=[32m"w-full flex 
items-center justify-between p-2 
rounded-lg transition-all group 
hover:bg-zinc-900/50"[39m
              
[33mstyle[39m=[32m"border-color: 
transparent;"[39m
            [36m>[39m
              [36m<div[39m
                
[33mclass[39m=[32m"flex items-center 
space-x-3"[39m
              [36m>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"p-1.5 rounded-md 
bg-zinc-800 text-text-muted 
group-hover:text-white 
transition-colors"[39m
                [36m>[39m
                  [36m<svg[39m

[2m Test Files [22m [1m[31m2 failed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m7 passed[39m[22m[90m (12)[39m
[2m   Start at [22m 11:00:35
[2m   Duration [22m 2.97s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
                    
[33mclass[39m=[32m"lucide 
lucide-zap"[39m
                    
[33mfill[39m=[32m"none"[39m
                    
[33mheight[39m=[32m"16"[39m
                    
[33mstroke[39m=[32m"currentColor"[39m
                    
[33mstroke-linecap[39m=[32m"round"[39m
                    [33mstroke-linejoin[
39m=[32m"round"[39m
                    
[33mstroke-width[39m=[32m"2"[39m
                    
[33mviewBox[39m=[32m"0 0 24 24"[39m
                    
[33mwidth[39m=[32m"16"[39m
                    [33mxmlns[39m=[32m"
http://www.w3.org/2000/svg"[39m
                  [36m>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M4 14a1 1 0 0 
1-.78-1.63l9.9-10.2a.5.5 0 0 1 
.86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 
0 1 .78 1.63l-9.9 10.2a.5.5 0 0 
1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</div>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"text-left"[39m
                [36m>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-xs font-bold 
text-white tracking-tight"[39m
                  [36m>[39m
                    [0mGPT[0m
                  [36m</p>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-[10px] 
text-text-muted line-clamp-1"[39m
                  [36m>[39m
                    [0mOpenAI GPT ΓÇö 
Best for speed[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div[39m
            
[33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<button[39m
              
[33mclass[39m=[32m"w-full flex 
items-center justify-between p-2 
rounded-lg transition-all group 
hover:bg-zinc-900/50"[39m
              
[33mstyle[39m=[32m"border-color: 
transparent;"[39m
            [36m>[39m
              [36m<div[39m
                
[33mclass[39m=[32m"flex items-center 
space-x-3"[39m
              [36m>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"p-1.5 rounded-md 
bg-zinc-800 text-text-muted 
group-hover:text-white 
transition-colors"[39m
                [36m>[39m
                  [36m<svg[39m
                    
[33mclass[39m=[32m"lucide 
lucide-sparkles"[39m
                    
[33mfill[39m=[32m"none"[39m
                    
[33mheight[39m=[32m"16"[39m
                    
[33mstroke[39m=[32m"currentColor"[39m
                    
[33mstroke-linecap[39m=[32m"round"[39m
                    [33mstroke-linejoin[
39m=[32m"round"[39m
                    
[33mstroke-width[39m=[32m"2"[39m
                    
[33mviewBox[39m=[32m"0 0 24 24"[39m
                    
[33mwidth[39m=[32m"16"[39m
                    [33mxmlns[39m=[32m"
http://www.w3.org/2000/svg"[39m
                  [36m>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M9.937 15.5A2 2 0 0 0 
8.5 14.063l-6.135-1.582a.5.5 0 0 1 
0-.962L8.5 9.936A2 2 0 0 0 9.937 
8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 
8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 
0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 
1.437l-1.582 6.135a.5.5 0 0 1-.963 
0z"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M20 3v4"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M22 5h-4"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M4 17v2"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M5 18H3"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</div>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"text-left"[39m
                [36m>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-xs font-bold 
text-white tracking-tight"[39m
                  [36m>[39m
                    [0mGemini[0m
                  [36m</p>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-[10px] 
text-text-muted line-clamp-1"[39m
                  [36m>[39m
                    [0mGoogle Gemini ΓÇö 
Best for multimodal[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
[90m [2mΓ¥»[22m Object.getElementError 
node_modules/@testing-library/dom/dist/con
fig.js:[2m37:19[22m[39m
[90m [2mΓ¥»[22m getElementError node_mo
dules/@testing-library/dom/dist/query-help
ers.js:[2m20:35[22m[39m
[90m [2mΓ¥»[22m 
getMultipleElementsFoundError node_modules
/@testing-library/dom/dist/query-helpers.j
s:[2m23:10[22m[39m
[90m [2mΓ¥»[22m node_modules/@testing-l
ibrary/dom/dist/query-helpers.js:[2m55:13
[22m[39m
[90m [2mΓ¥»[22m node_modules/@testing-l
ibrary/dom/dist/query-helpers.js:[2m95:19
[22m[39m
[36m [2mΓ¥»[22m src/test/integration/ai
ProviderSelector.test.tsx:[2m32:19[22m[
39m
    [90m 30| [39m    
    [90m 31| [39m    [90m// Names from 
AI_PROVIDERS: 'Claude', 'GPT', 
'Gemini'[39m
    [90m 32| [39m    [34mexpect[39m(sc
reen[33m.[39m[34mgetByText[39m([32m'C
laude'[39m))[33m.[39m[34mtoBeInTheDocu
ment[39m()[33m;[39m
    [90m   | [39m                  
[31m^[39m
    [90m 33| [39m    [34mexpect[39m(sc
reen[33m.[39m[34mgetByText[39m([32m'G
PT'[39m))[33m.[39m[34mtoBeInTheDocumen
t[39m()[33m;[39m
    [90m 34| [39m    [34mexpect[39m(sc
reen[33m.[39m[34mgetByText[39m([32m'G
emini'[39m))[33m.[39m[34mtoBeInTheDocu
ment[39m()[33m;[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[1/
1]ΓÄ»[22m[39m

c[3J[1m[44m RERUN [49m[22m [34m[2msrc/components/ui/AIProviderSelector.tsx [22m[39m

 [31mΓ¥»[39m src/test/unit/websocket.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 158[2mms[22m[39m
     [32mΓ£ô[39m should connect with correct URL including token[32m 28[2mms[22m[39m
[31m     [31m├ù[31m should transition to connected state on open[39m[32m 18[2mms[22m[39m
[31m     [31m├ù[31m should send PING every 30s[39m[32m 41[2mms[22m[39m
[31m     [31m├ù[31m should disconnect on missing PONG[39m[32m 22[2mms[22m[39m
[31m     [31m├ù[31m should reconnect after disconnect with backoff[39m[32m 6[2mms[22m[39m
     [32mΓ£ô[39m should cap backoff at 30s[32m 27[2mms[22m[39m
     [32mΓ£ô[39m should discard malformed message without throwing[32m 9[2mms[22m[39m
 [32mΓ£ô[39m src/test/unit/aiProvider.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 438[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m renders all 3 providers [33m 338[2mms[22m[39m
 [31mΓ¥»[39m src/test/integration/aiProviderSelector.test.tsx [2m([22m[2m5 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 1852[2mms[22m[39m
     [32mΓ£ô[39m renders in compact mode by default[32m 150[2mms[22m[39m
[31m     [31m├ù[31m opens panel and shows all 3 providers[39m[33m 462[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m updates store and fires toast when selecting Gemini [33m 502[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m allows model selection per provider [33m 515[2mms[22m[39m
     [32mΓ£ô[39m persists selection to localStorage[32m 217[2mms[22m[39m

[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m[1m[41m 
Failed Tests 1 
[49m[22m[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m

[41m[1m FAIL [22m[49m src/test/integra
tion/aiProviderSelector.test.tsx[2m > 
[22mAIProviderSelector Integration[2m > 
[22mopens panel and shows all 3 providers
[31m[1mTestingLibraryElementError[22m[
39m: Found multiple elements with the 
text: Claude

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<span[39m
  [33mclass[39m=[32m"text-[10px] 
font-bold text-white uppercase 
tracking-tight"[39m
[36m>[39m
  [0mClaude[0m
  [0m [0m
  [36m<span[39m
    [33mclass[39m=[32m"text-text-muted 
font-normal ml-1"[39m
  [36m>[39m
    [0m/ [0m
    [0mclaude-sonnet-4-5[0m
  [36m</span>[39m
[36m</span>[39m

Ignored nodes: comments, script, style
[36m<p[39m
  [33mclass[39m=[32m"text-xs font-bold 
text-white tracking-tight"[39m
[36m>[39m
  [0mClaude[0m
[36m</p>[39m

(If this is intentional, then use the 
`*AllBy*` variant of the query (like 
`queryAllByText`, `getAllByText`, or 
`findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[39m
  [36m<div>[39m
    [36m<div[39m
      [33mclass[39m=[32m"relative"[39m
    [36m>[39m
      [36m<button[39m
        [33mclass[39m=[32m"flex 
items-center space-x-2 px-3 py-1.5 
rounded-full bg-zinc-900 border 
border-fin-border hover:border-zinc-600 
transition-colors"[39m
        [33mdata-testid[39m=[32m"ai-pro
vider-selector-trigger"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"w-2 h-2 
rounded-full shadow-[0_0_8px_rgba(var(--co
lor-primary-rgb),0.5)]"[39m
          
[33mstyle[39m=[32m"background-color: 
rgb(217, 119, 6);"[39m
        [36m/>[39m
        [36m<span[39m
          
[33mclass[39m=[32m"text-[10px] 
font-bold text-white uppercase 
tracking-tight"[39m
        [36m>[39m
          [0mClaude[0m
          [0m [0m
          [36m<span[39m
            
[33mclass[39m=[32m"text-text-muted 
font-normal ml-1"[39m
          [36m>[39m
            [0m/ [0m
            [0mclaude-sonnet-4-5[0m
          [36m</span>[39m
        [36m</span>[39m
        [36m<svg[39m
          [33mclass[39m=[32m"lucide 
lucide-chevron-down text-text-muted 
transition-transform rotate-180"[39m
          [33mfill[39m=[32m"none"[39m
          [33mheight[39m=[32m"12"[39m
          
[33mstroke[39m=[32m"currentColor"[39m
          
[33mstroke-linecap[39m=[32m"round"[39m
          [33mstroke-linejoin[39m=[32m"
round"[39m
          
[33mstroke-width[39m=[32m"2"[39m
          [33mviewBox[39m=[32m"0 0 24 
24"[39m
          [33mwidth[39m=[32m"12"[39m
          [33mxmlns[39m=[32m"http://www
.w3.org/2000/svg"[39m
        [36m>[39m
          [36m<path[39m
            [33md[39m=[32m"m6 9 6 6 
6-6"[39m
          [36m/>[39m
        [36m</svg>[39m
      [36m</button>[39m
      [36m<div[39m
        [33mclass[39m=[32m"absolute 
top-full right-0 mt-2 w-64 bg-zinc-950 
border border-fin-border rounded-xl 
shadow-2xl z-[100] overflow-hidden"[39m
        [33mstyle[39m=[32m"opacity: 0; 
transform: translateY(10px) 
scale(0.95);"[39m
      [36m>[39m
        [36m<div[39m
          [33mclass[39m=[32m"p-2 
space-y-1"[39m
        [36m>[39m
          [36m<div[39m
            
[33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<button[39m
              
[33mclass[39m=[32m"w-full flex 
items-center justify-between p-2 
rounded-lg transition-all group 
bg-zinc-900 ring-1 ring-inset"[39m
              [33mdata-testid[39m=[32m"
ai-provider-option-anthropic"[39m
              
[33mstyle[39m=[32m"border-color: 
rgb(217, 119, 6);"[39m
            [36m>[39m
              [36m<div[39m
                
[33mclass[39m=[32m"flex items-center 
space-x-3"[39m
              [36m>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"p-1.5 rounded-md 
bg-zinc-800 text-text-muted 
group-hover:text-white 
transition-colors"[39m
                  
[33mstyle[39m=[32m"color: rgb(217, 
119, 6);"[39m
                [36m>[39m
                  [36m<svg[39m
                    
[33mclass[39m=[32m"lucide 
lucide-bot"[39m
                    
[33mfill[39m=[32m"none"[39m
                    
[33mheight[39m=[32m"16"[39m
                    
[33mstroke[39m=[32m"currentColor"[39m
                    
[33mstroke-linecap[39m=[32m"round"[39m
                    [33mstroke-linejoin[
39m=[32m"round"[39m
                    
[33mstroke-width[39m=[32m"2"[39m
                    
[33mviewBox[39m=[32m"0 0 24 24"[39m
                    
[33mwidth[39m=[32m"16"[39m
                    [33mxmlns[39m=[32m"
http://www.w3.org/2000/svg"[39m
                  [36m>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M12 8V4H8"[39m
                    [36m/>[39m
                    [36m<rect[39m
                      
[33mheight[39m=[32m"12"[39m
                      
[33mrx[39m=[32m"2"[39m
                      
[33mwidth[39m=[32m"16"[39m
                      
[33mx[39m=[32m"4"[39m
                      
[33my[39m=[32m"8"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M2 14h2"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M20 14h2"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M15 13v2"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M9 13v2"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</div>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"text-left"[39m
                [36m>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-xs font-bold 
text-white tracking-tight"[39m
                  [36m>[39m
                    [0mClaude[0m
                  [36m</p>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-[10px] 
text-text-muted line-clamp-1"[39m
                  [36m>[39m
                    [0mAnthropic Claude 
ΓÇö Best for nuanced analysis[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
              [36m<svg[39m
                
[33mclass[39m=[32m"lucide 
lucide-check"[39m
                
[33mfill[39m=[32m"none"[39m
                
[33mheight[39m=[32m"14"[39m
                
[33mstroke[39m=[32m"currentColor"[39m
                
[33mstroke-linecap[39m=[32m"round"[39m
                [33mstroke-linejoin[39m=
[32m"round"[39m
                
[33mstroke-width[39m=[32m"2"[39m
                
[33mstyle[39m=[32m"color: rgb(217, 
119, 6);"[39m
                [33mviewBox[39m=[32m"0 
0 24 24"[39m
                
[33mwidth[39m=[32m"14"[39m
                [33mxmlns[39m=[32m"http
://www.w3.org/2000/svg"[39m
              [36m>[39m
                [36m<path[39m
                  [33md[39m=[32m"M20 6 
9 17l-5-5"[39m
                [36m/>[39m
              [36m</svg>[39m
            [36m</button>[39m
            [36m<div[39m
              [33mclass[39m=[32m"ml-10 
pr-2 pb-2"[39m
            [36m>[39m
              [36m<select[39m
                
[33mclass[39m=[32m"w-full bg-zinc-900 
border border-zinc-800 text-[10px] 
text-zinc-300 rounded px-2 py-1 
focus:outline-none 
focus:border-zinc-600"[39m
                [33mdata-testid[39m=[32
m"ai-model-select"[39m
              [36m>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"cl
aude-opus-4-5"[39m
                [36m>[39m
                  [0mclaude-opus-4-5[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"cl
aude-sonnet-4-5"[39m
                [36m>[39m
                  
[0mclaude-sonnet-4-5[0m
                [36m</option>[39m
                [36m<option[39m
                  [33mvalue[39m=[32m"cl
aude-haiku-4-5"[39m
                [36m>[39m
                  [0mclaude-haiku-4-5[0m
                [36m</option>[39m
              [36m</select>[39m
            [36m</div>[39m
          [36m</div>[39m
          [36m<div[39m
            
[33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<button[39m
              
[33mclass[39m=[32m"w-full flex 
items-center justify-between p-2 
rounded-lg transition-all group 
hover:bg-zinc-900/50"[39m
              [33mdata-testid[39m=[32m"
ai-provider-option-openai"[39m
              
[33mstyle[39m=[32m"border-color: 
transparent;"[39m
            [36m>[39m
              [36m<div[39m
                
[33mclass[39m=[32m"flex items-center 
space-x-3"[39m
              [36m>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"p-1.5 rounded-md 
bg-zinc-800 text-text-muted 
group-hover:text-white 
transition-colors"[39m
                [36m>[39m
                  [36m<svg[39m
                    
[33mclass[39m=[32m"lucide 
lucide-zap"[39m
                    
[33mfill[39m=[32m"none"[39m
                    
[33mheight[39m=[32m"16"[39m
                    
[33mstroke[39m=[32m"currentColor"[39m
                    
[33mstroke-linecap[39m=[32m"round"[39m
                    [33mstroke-linejoin[
39m=[32m"round"[39m
                    
[33mstroke-width[39m=[32m"2"[39m
                    
[33mviewBox[39m=[32m"0 0 24 24"[39m
                    
[33mwidth[39m=[32m"16"[39m
                    [33mxmlns[39m=[32m"
http://www.w3.org/2000/svg"[39m

                  [36m>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M4 14a1 1 0 0 
1-.78-1.63l9.9-10.2a.5.5 0 0 1 
.86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 
0 1 .78 1.63l-9.9 10.2a.5.5 0 0 
1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</div>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"text-left"[39m
                [36m>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-xs font-bold 
text-white tracking-tight"[39m
                  [36m>[39m
                    [0mGPT[0m
                  [36m</p>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-[10px] 
text-text-muted line-clamp-1"[39m
                  [36m>[39m
                    [0mOpenAI GPT ΓÇö 
Best for speed[0m
                  [36m</p>[39m
[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (3)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m12 passed[39m[22m[90m (17)[39m
[2m   Start at [22m 11:01:24
[2m   Duration [22m 7.07s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
                [36m</div>[39m
              [36m</div>[39m
            [36m</button>[39m
          [36m</div>[39m
          [36m<div[39m
            
[33mclass[39m=[32m"space-y-1"[39m
          [36m>[39m
            [36m<button[39m
              
[33mclass[39m=[32m"w-full flex 
items-center justify-between p-2 
rounded-lg transition-all group 
hover:bg-zinc-900/50"[39m
              [33mdata-testid[39m=[32m"
ai-provider-option-gemini"[39m
              
[33mstyle[39m=[32m"border-color: 
transparent;"[39m
            [36m>[39m
              [36m<div[39m
                
[33mclass[39m=[32m"flex items-center 
space-x-3"[39m
              [36m>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"p-1.5 rounded-md 
bg-zinc-800 text-text-muted 
group-hover:text-white 
transition-colors"[39m
                [36m>[39m
                  [36m<svg[39m
                    
[33mclass[39m=[32m"lucide 
lucide-sparkles"[39m
                    
[33mfill[39m=[32m"none"[39m
                    
[33mheight[39m=[32m"16"[39m
                    
[33mstroke[39m=[32m"currentColor"[39m
                    
[33mstroke-linecap[39m=[32m"round"[39m
                    [33mstroke-linejoin[
39m=[32m"round"[39m
                    
[33mstroke-width[39m=[32m"2"[39m
                    
[33mviewBox[39m=[32m"0 0 24 24"[39m
                    
[33mwidth[39m=[32m"16"[39m
                    [33mxmlns[39m=[32m"
http://www.w3.org/2000/svg"[39m
                  [36m>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M9.937 15.5A2 2 0 0 0 
8.5 14.063l-6.135-1.582a.5.5 0 0 1 
0-.962L8.5 9.936A2 2 0 0 0 9.937 
8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 
8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 
0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 
1.437l-1.582 6.135a.5.5 0 0 1-.963 
0z"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M20 3v4"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M22 5h-4"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M4 17v2"[39m
                    [36m/>[39m
                    [36m<path[39m
                      
[33md[39m=[32m"M5 18H3"[39m
                    [36m/>[39m
                  [36m</svg>[39m
                [36m</div>[39m
                [36m<div[39m
                  
[33mclass[39m=[32m"text-left"[39m
                [36m>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-xs font-bold 
text-white tracking-tight"[39m
                  [36m>[39m
                    [0mGemini[0m
                  [36m</p>[39m
                  [36m<p[39m
                    
[33mclass[39m=[32m"text-[10px] 
text-text-muted line-clamp-1"[39m
                  [36m>[39m
                    [0mGoogle Gemini ΓÇö 
Best for multimodal[0m
                  [36m</p>[39m
                [36m</div>[39m
              [36m</div>[39m
            [36m</button>[39m
          [36m</div>[39m
        [36m</div>[39m
      [36m</div>[39m
    [36m</div>[39m
  [36m</div>[39m
[36m</body>[39m
[90m [2mΓ¥»[22m Object.getElementError 
node_modules/@testing-library/dom/dist/con
fig.js:[2m37:19[22m[39m
[90m [2mΓ¥»[22m getElementError node_mo
dules/@testing-library/dom/dist/query-help
ers.js:[2m20:35[22m[39m
[90m [2mΓ¥»[22m 
getMultipleElementsFoundError node_modules
/@testing-library/dom/dist/query-helpers.j
s:[2m23:10[22m[39m
[90m [2mΓ¥»[22m node_modules/@testing-l
ibrary/dom/dist/query-helpers.js:[2m55:13
[22m[39m
[90m [2mΓ¥»[22m node_modules/@testing-l
ibrary/dom/dist/query-helpers.js:[2m95:19
[22m[39m
[36m [2mΓ¥»[22m src/test/integration/ai
ProviderSelector.test.tsx:[2m32:19[22m[
39m
    [90m 30| [39m    
    [90m 31| [39m    [90m// Names from 
AI_PROVIDERS: 'Claude', 'GPT', 
'Gemini'[39m
    [90m 32| [39m    [34mexpect[39m(sc
reen[33m.[39m[34mgetByText[39m([32m'C
laude'[39m))[33m.[39m[34mtoBeInTheDocu
ment[39m()[33m;[39m
    [90m   | [39m                  
[31m^[39m
    [90m 33| [39m    [34mexpect[39m(sc
reen[33m.[39m[34mgetByText[39m([32m'G
PT'[39m))[33m.[39m[34mtoBeInTheDocumen
t[39m()[33m;[39m
    [90m 34| [39m    [34mexpect[39m(sc
reen[33m.[39m[34mgetByText[39m([32m'G
emini'[39m))[33m.[39m[34mtoBeInTheDocu
ment[39m()[33m;[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[1/
1]ΓÄ»[22m[39m

c[3J[1m[44m RERUN [49m[22m [34m[2msrc/test/integration/aiProviderSelector.test.tsx [22m[34mx3 [34m[39m

 [31mΓ¥»[39m src/test/unit/websocket.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 158[2mms[22m[39m
     [32mΓ£ô[39m should connect with correct URL including token[32m 28[2mms[22m[39m
[31m     [31m├ù[31m should transition to connected state on open[39m[32m 18[2mms[22m[39m
[31m     [31m├ù[31m should send PING every 30s[39m[32m 41[2mms[22m[39m
[31m     [31m├ù[31m should disconnect on missing PONG[39m[32m 22[2mms[22m[39m
[31m     [31m├ù[31m should reconnect after disconnect with backoff[39m[32m 6[2mms[22m[39m
     [32mΓ£ô[39m should cap backoff at 30s[32m 27[2mms[22m[39m
     [32mΓ£ô[39m should discard malformed message without throwing[32m 9[2mms[22m[39m
 [32mΓ£ô[39m src/test/integration/aiProviderSelector.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[33m 1407[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m opens panel and shows all 3 providers [33m 407[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m updates store and fires toast when selecting Gemini [33m 306[2mms[22m[39m
     [33m[2mΓ£ô[22m[39m allows model selection per provider [33m 373[2mms[22m[39m

[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[31m4 failed[39m[22m[2m | [22m[1m[32m8 passed[39m[22m[90m (12)[39m
[2m   Start at [22m 11:01:35
[2m   Duration [22m 2.83s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/test/unit/aiProvider.test.tsx [22m[34mx2 [34m[39m

 [31mΓ¥»[39m src/test/unit/websocket.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 158[2mms[22m[39m
     [32mΓ£ô[39m should connect with correct URL including token[32m 28[2mms[22m[39m
[31m     [31m├ù[31m should transition to connected state on open[39m[32m 18[2mms[22m[39m
[31m     [31m├ù[31m should send PING every 30s[39m[32m 41[2mms[22m[39m
[31m     [31m├ù[31m should disconnect on missing PONG[39m[32m 22[2mms[22m[39m
[31m     [31m├ù[31m should reconnect after disconnect with backoff[39m[32m 6[2mms[22m[39m
     [32mΓ£ô[39m should cap backoff at 30s[32m 27[2mms[22m[39m
     [32mΓ£ô[39m should discard malformed message without throwing[32m 9[2mms[22m[39m
 [31mΓ¥»[39m src/test/unit/aiProvider.test.tsx [2m([22m[2m5 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 243[2mms[22m[39m
     [32mΓ£ô[39m should have all 3 providers[32m 4[2mms[22m[39m
     [32mΓ£ô[39m should have valid models array for each provider[32m 1[2mms[22m[39m
     [32mΓ£ô[39m renders all 3 providers[32m 159[2mms[22m[39m
     [32mΓ£ô[39m selecting provider updates store[32m 43[2mms[22m[39m
[31m     [31m├ù[31m provider name rendered in selector UI[39m[32m 32[2mms[22m[39m

[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m[1m[41m 
Failed Tests 1 
[49m[22m[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m

[41m[1m FAIL [22m[49m 
src/test/unit/aiProvider.test.tsx[2m > 
[22mAIProviderSelector Component[2m > 
[22mprovider name rendered in selector UI
[31m[1mTestingLibraryElementError[22m: 
Found multiple elements with the text: 
/Claude/i

Here are the matching elements:

Ignored nodes: comments, script, style
[36m<span[31m
  [33mclass[31m=[32m"text-[10px] 
font-bold text-white uppercase 
tracking-tight"[31m
[36m>[31m
  [0mClaude[0m
  [0m [0m
  [36m<span[31m
    [33mclass[31m=[32m"text-text-muted 
font-normal ml-1"[31m
  [36m>[31m
    [0m/ [0m
    [0mclaude-sonnet-4-5[0m
  [36m</span>[31m
[36m</span>[31m

Ignored nodes: comments, script, style
[36m<span[31m
  [33mclass[31m=[32m"text-text-muted 
font-normal ml-1"[31m
[36m>[31m
  [0m/ [0m
  [0mclaude-sonnet-4-5[0m
[36m</span>[31m

(If this is intentional, then use the 
`*AllBy*` variant of the query (like 
`queryAllByText`, `getAllByText`, or 
`findAllByText`)).

Ignored nodes: comments, script, style
[36m<body>[31m
  [36m<div>[31m
    [36m<div[31m
      [33mclass[31m=[32m"relative"[31m
    [36m>[31m
      [36m<button[31m
        [33mclass[31m=[32m"flex 
items-center space-x-2 px-3 py-1.5 
rounded-full bg-zinc-900 border 
border-fin-border hover:border-zinc-600 
transition-colors"[31m
        [33mdata-testid[31m=[32m"ai-pro
vider-selector-trigger"[31m
      [36m>[31m
        [36m<div[31m
          [33mclass[31m=[32m"w-2 h-2 
rounded-full shadow-[0_0_8px_rgba(var(--co
lor-primary-rgb),0.5)]"[31m
          
[33mstyle[31m=[32m"background-color: 
rgb(217, 119, 6);"[31m
        [36m/>[31m
        [36m<span[31m
          
[33mclass[31m=[32m"text-[10px] 
font-bold text-white uppercase 
tracking-tight"[31m
        [36m>[31m
          [0mClaude[0m
          [0m [0m
          [36m<span[31m
            
[33mclass[31m=[32m"text-text-muted 
font-normal ml-1"[31m
          [36m>[31m
            [0m/ [0m
            [0mclaude-sonnet-4-5[0m
          [36m</span>[31m
        [36m</span>[31m
        [36m<svg[31m
          [33mclass[31m=[32m"lucide 
lucide-chevron-down text-text-muted 
transition-transform"[31m
          [33mfill[31m=[32m"none"[31m
          [33mheight[31m=[32m"12"[31m
          
[33mstroke[31m=[32m"currentColor"[31m
          
[33mstroke-linecap[31m=[32m"round"[31m
          [33mstroke-linejoin[31m=[32m"
round"[31m
          
[33mstroke-width[31m=[32m"2"[31m
          [33mviewBox[31m=[32m"0 0 24 
24"[31m
          [33mwidth[31m=[32m"12"[31m
          [33mxmlns[31m=[32m"http://www
.w3.org/2000/svg"[31m
        [36m>[31m
          [36m<path[31m
            [33md[31m=[32m"m6 9 6 6 
6-6"[31m
          [36m/>[31m
        [36m</svg>[31m
      [36m</button>[31m
    [36m</div>[31m
  [36m</div>[31m
[36m</body>[31m[39m
[90m [2mΓ¥»[22m Object.getElementError 
node_modules/@testing-library/dom/dist/con
fig.js:[2m37:19[22m[39m
[90m [2mΓ¥»[22m getElementError node_mo
dules/@testing-library/dom/dist/query-help
ers.js:[2m20:35[22m[39m
[90m [2mΓ¥»[22m 
getMultipleElementsFoundError node_modules
/@testing-library/dom/dist/query-helpers.j
s:[2m23:10[22m[39m
[90m [2mΓ¥»[22m node_modules/@testing-l
ibrary/dom/dist/query-helpers.js:[2m55:13
[22m[39m
[90m [2mΓ¥»[22m node_modules/@testing-l
ibrary/dom/dist/query-helpers.js:[2m95:19
[22m[39m
[36m [2mΓ¥»[22m src/test/unit/aiProvide
r.test.tsx:[2m63:19[22m[39m
    [90m 61| [39m    
    [90m 62| [39m    [90m// Check if 
the current provider's name is rendered 
in the trigger[39m
    [90m 63| [39m    
expect(screen.getByText(new 
RegExp(currentProvider!.name, 'i'))).tΓÇª
    [90m   | [39m                  
[31m^[39m
    [90m 64| [39m  })[33m;[39m
    [90m 65| [39m})[33m;[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[1/
1]ΓÄ»[22m[39m


[2m Test Files [22m [1m[31m2 failed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m7 passed[39m[22m[90m (12)[39m
[2m   Start at [22m 11:01:59
[2m   Duration [22m 1.56s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/test/unit/websocket.test.ts [22m[34mx1 [34m[39m

 [31mΓ¥»[39m src/test/unit/aiProvider.test.tsx [2m([22m[2m5 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 243[2mms[22m[39m
     [32mΓ£ô[39m should have all 3 providers[32m 4[2mms[22m[39m
     [32mΓ£ô[39m should have valid models array for each provider[32m 1[2mms[22m[39m
     [32mΓ£ô[39m renders all 3 providers[32m 159[2mms[22m[39m
     [32mΓ£ô[39m selecting provider updates store[32m 43[2mms[22m[39m
[31m     [31m├ù[31m provider name rendered in selector UI[39m[32m 32[2mms[22m[39m
[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould connect with correct URL
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould connect with correct URL
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:42:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould transition to connected state on open
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould transition to connected 
state on open
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:48:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould send PING every 30s
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)
[WS] Reconnecting in 2000ms (attempt 2)
[WS] Reconnecting in 4000ms (attempt 3)
[WS] Reconnecting in 8000ms (attempt 4)
[WS] Reconnecting in 16000ms (attempt 5)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould send PING every 30s
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:55:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:59:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:59:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:59:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:59:8

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould disconnect on missing PONG
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)
[WS] Reconnecting in 2000ms (attempt 2)
[WS] Reconnecting in 4000ms (attempt 3)
[WS] Reconnecting in 8000ms (attempt 4)
[WS] Reconnecting in 16000ms (attempt 5)
[WS] Reconnecting in 30000ms (attempt 6)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould disconnect on missing PONG
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:64:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:68:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:68:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:68:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:68:8
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at FakeTimers.advanceTimersByTime [90
m(file:///C:/Users/mrnlu/repos/agent-predi
ct-war-room-backend-research-docs/[39mnod
e_modules/[4mvitest[24m/dist/chunks/vi.2
VT5v0um.js:3529:44[90m)[39m
    at Object.advanceTimersByTime [90m(fi
le:///C:/Users/mrnlu/repos/agent-predict-w
ar-room-backend-research-docs/[39mnode_mo
dules/[4mvitest[24m/dist/chunks/vi.2VT5v
0um.js:3760:13[90m)[39m
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:69:8

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould reconnect after disconnect
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould reconnect after disconnect
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:76:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould cap backoff
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)
[WS] Reconnecting in 2000ms (attempt 2)
[WS] Reconnecting in 4000ms (attempt 3)
[WS] Reconnecting in 8000ms (attempt 4)
[WS] Reconnecting in 16000ms (attempt 5)
[WS] Reconnecting in 30000ms (attempt 6)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould cap backoff
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:89:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m
[vitest] The vi.fn() mock did not use 
'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/service
s/websocket/WebSocketClient.ts:139:12
    at callTimer [90m(file:///C:/Users/mr
nlu/repos/agent-predict-war-room-backend-r
esearch-docs/[39mnode_modules/[4mvitest
[24m/dist/chunks/vi.2VT5v0um.js:2111:25[9
0m)[39m
    at doTickInner [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2714:30
[90m)[39m
    at doTick [90m(file:///C:/Users/mrnlu
/repos/agent-predict-war-room-backend-rese
arch-docs/[39mnode_modules/[4mvitest[24
m/dist/chunks/vi.2VT5v0um.js:2795:21[90m)
[39m
    at Object.tick [90m(file:///C:/Users/
mrnlu/repos/agent-predict-war-room-backend
-research-docs/[39mnode_modules/[4mvites
t[24m/dist/chunks/vi.2VT5v0um.js:2803:21
[90m)[39m
    at Object.runToLast [90m(file:///C:/U
sers/mrnlu/repos/agent-predict-war-room-ba
ckend-research-docs/[39mnode_modules/[4m
vitest[24m/dist/chunks/vi.2VT5v0um.js:296
2:27[90m)[39m
    at FakeTimers.runOnlyPendingTimers [9
0m(file:///C:/Users/mrnlu/repos/agent-pred
ict-war-room-backend-research-docs/[39mno
de_modules/[4mvitest[24m/dist/chunks/vi.
2VT5v0um.js:3507:44[90m)[39m
    at Object.runOnlyPendingTimers [90m(f
ile:///C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/[39mnode_m
odules/[4mvitest[24m/dist/chunks/vi.2VT5
v0um.js:3740:13[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould discard malformed message
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould discard malformed message
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => 
createMockSocket() is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:103:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

 [31mΓ¥»[39m src/test/unit/websocket.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 91[2mms[22m[39m
     [32mΓ£ô[39m should connect with correct URL[32m 21[2mms[22m[39m
[31m     [31m├ù[31m should transition to connected state on open[39m[32m 15[2mms[22m[39m
[31m     [31m├ù[31m should send PING every 30s[39m[32m 11[2mms[22m[39m
[31m     [31m├ù[31m should disconnect on missing PONG[39m[32m 17[2mms[22m[39m
[31m     [31m├ù[31m should reconnect after disconnect[39m[32m 5[2mms[22m[39m
     [32mΓ£ô[39m should cap backoff[32m 11[2mms[22m[39m
     [32mΓ£ô[39m should discard malformed message[32m 6[2mms[22m[39m

[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m[1m[41m 
Failed Tests 4 
[49m[22m[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
transition to connected state on open
[31m[1mAssertionError[22m: expected 
"vi.fn()" to be called with arguments: [ 
'connected' ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[32m-   "connected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  2nd vi.fn() call:

[22m[2m  [[22m
[32m-   "connected",[90m
[31m+   "error",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m2[22m
[31m[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m51:27[22m[39m
    [90m 49| [39m    [35mconst[39m 
socket [33m=[39m 
[34mgetSocket[39m()[33m;[39m
    [90m 50| [39m    [35mif[39m 
(socket[33m.[39monopen) socket[33m.[39
m[34monopen[39m()[33m;[39m
    [90m 51| [39m    [34mexpect[39m(on
StateChange)[33m.[39m[34mtoHaveBeenCall
edWith[39m([32m'connected'[39m)[33m;[
39m
    [90m   | [39m                       
   [31m^[39m
    [90m 52| [39m  })[33m;[39m
    [90m 53| [39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[1/
4]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
send PING every 30s
[31m[1mTypeError[22m: undefined is not 
a spy or a call to a spy![39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m60:25[22m[39m
    [90m 58| [39m    
    [90m 59| [39m    vi[33m.[39m[34ma
dvanceTimersByTime[39m([34m30000[39m)[
33m;[39m
    [90m 60| [39m    [34mexpect[39m(so
cket[33m.[39msend)[33m.[39m[34mtoHave
BeenCalled[39m()[33m;[39m
    [90m   | [39m                       
 [31m^[39m
    [90m 61| [39m  })[33m;[39m
    [90m 62| [39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[2/
4]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
disconnect on missing PONG
[31m[1mAssertionError[22m: expected 
"vi.fn()" to be called with arguments: [ 
'disconnected' ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  2nd vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  3rd vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  4th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  5th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  6th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  7th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  8th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  9th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  10th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m

[1m  11th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  12th vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m12[22m
[31m[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m71:27[22m[39m
    [90m 69| [39m    vi[33m.[39m[34ma
dvanceTimersByTime[39m([34m11000[39m)[
33m;[39m [90m// Wait for PONG timeout 
(10s)[39m
    [90m 70| [39m    
    [90m 71| [39m    [34mexpect[39m(on
StateChange)[33m.[39m[34mtoHaveBeenCall
edWith[39m([32m'disconnected'[39m)[33m
;[39m
    [90m   | [39m                       
   [31m^[39m
    [90m 72| [39m    [34mexpect[39m(so
cket[33m.[39mclose)[33m.[39m[34mtoHav
eBeenCalled[39m()[33m;[39m
    [90m 73| [39m  })[33m;[39m

[2m Test Files [22m [1m[31m2 failed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m7 passed[39m[22m[90m (12)[39m
[2m   Start at [22m 11:03:15
[2m   Duration [22m 729ms

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[3/
4]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
reconnect after disconnect
[31m[1mAssertionError[22m: expected 
"vi.fn()" to be called with arguments: [ 
'disconnected' ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "connecting",[90m
[2m  ][22m

[1m  2nd vi.fn() call:

[22m[2m  [[22m
[32m-   "disconnected",[90m
[31m+   "error",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m2[22m
[31m[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m81:27[22m[39m
    [90m 79| [39m    [35mif[39m 
(socket1[33m.[39monclose) socket1[33m.
[39m[34monclose[39m()[33m;[39m
    [90m 80| [39m    
    [90m 81| [39m    [34mexpect[39m(on
StateChange)[33m.[39m[34mtoHaveBeenCall
edWith[39m([32m'disconnected'[39m)[33m
;[39m
    [90m   | [39m                       
   [31m^[39m
    [90m 82| [39m    
    [90m 83| [39m    [90m// Attempt 1 
(1000ms)[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[4/
4]ΓÄ»[22m[39m

       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/test/unit/aiProvider.test.tsx [22m[34mx3 [34m[39m

 [31mΓ¥»[39m src/test/unit/websocket.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 91[2mms[22m[39m
     [32mΓ£ô[39m should connect with correct URL[32m 21[2mms[22m[39m
[31m     [31m├ù[31m should transition to connected state on open[39m[32m 15[2mms[22m[39m
[31m     [31m├ù[31m should send PING every 30s[39m[32m 11[2mms[22m[39m
[31m     [31m├ù[31m should disconnect on missing PONG[39m[32m 17[2mms[22m[39m
[31m     [31m├ù[31m should reconnect after disconnect[39m[32m 5[2mms[22m[39m
     [32mΓ£ô[39m should cap backoff[32m 11[2mms[22m[39m
     [32mΓ£ô[39m should discard malformed message[32m 6[2mms[22m[39m
 [32mΓ£ô[39m src/test/unit/aiProvider.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 247[2mms[22m[39m

[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[31m4 failed[39m[22m[2m | [22m[1m[32m8 passed[39m[22m[90m (12)[39m
[2m   Start at [22m 11:03:22
[2m   Duration [22m 1.64s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2msrc/test/unit/websocket.test.ts [22m[34mx2 [34m[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould connect and update state
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould connect and update state
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => {
      const s = createMockSocket();
      mockSockets.push(s);
      return s;
    } is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:44:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould handle open
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould handle open
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => {
      const s = createMockSocket();
      mockSockets.push(s);
      return s;
    } is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:50:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould send heartbeat
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould send heartbeat
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => {
      const s = createMockSocket();
      mockSockets.push(s);
      return s;
    } is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:57:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould disconnect on pong timeout
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould disconnect on pong timeout
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => {
      const s = createMockSocket();
      mockSockets.push(s);
      return s;
    } is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:66:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould reconnect
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => {
      const s = createMockSocket();
      mockSockets.push(s);
      return s;
    } is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould reconnect
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:78:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m


[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould cap reconnection delay
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould cap reconnection delay
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => {
      const s = createMockSocket();
      mockSockets.push(s);
      return s;
    } is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:90:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

[90mstdout[2m | src/test/unit/websocket.test.ts[2m > [22m[2mWebSocketClient[2m > [22m[2mshould not throw on malformed JSON
[22m[39m[WS] Reconnecting in 1000ms (attempt 1)

[90mstderr[2m | 
src/test/unit/websocket.test.ts[2m > 
[22m[2mWebSocketClient[2m > 
[22m[2mshould not throw on malformed 
JSON
[22m[39m[vitest] The vi.fn() mock did 
not use 'function' or 'class' in its 
implementation, see 
https://vitest.dev/api/vi#vi-spyon for 
examples.
[WS] Connection error: TypeError: () => {
      const s = createMockSocket();
      mockSockets.push(s);
      return s;
    } is not a constructor
    at new Mock [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4m@vitest
[24m/spy/dist/index.js:262:27[90m)[39m
    at WebSocketClient.connect (C:/Users/m
rnlu/repos/agent-predict-war-room-backend-
research-docs/src/services/websocket/WebSo
cketClient.ts:40:21)
    at C:/Users/mrnlu/repos/agent-predict-
war-room-backend-research-docs/src/test/un
it/websocket.test.ts:102:12
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:145:11
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:915:26
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///C:/Use
rs/mrnlu/repos/agent-predict-war-room-back
end-research-docs/[39mnode_modules/[4m@v
itest[24m/runner/dist/index.js:1209:10[9
0m)[39m
    at [90mfile:///C:/Users/mrnlu/repos/a
gent-predict-war-room-backend-research-doc
s/[39mnode_modules/[4m@vitest[24m/runne
r/dist/index.js:1653:37
    at Traces.$ [90m(file:///C:/Users/mrn
lu/repos/agent-predict-war-room-backend-re
search-docs/[39mnode_modules/[4mvitest[
24m/dist/chunks/traces.CCmnQaNT.js:142:27
[90m)[39m

 [31mΓ¥»[39m src/test/unit/websocket.test.ts [2m([22m[2m7 tests[22m[2m | [22m[31m7 failed[39m[2m)[22m[32m 115[2mms[22m[39m
[31m     [31m├ù[31m should connect and update state[39m[32m 40[2mms[22m[39m
[31m     [31m├ù[31m should handle open[39m[32m 21[2mms[22m[39m
[31m     [31m├ù[31m should send heartbeat[39m[32m 23[2mms[22m[39m
[31m     [31m├ù[31m should disconnect on pong timeout[39m[32m 7[2mms[22m[39m
[31m     [31m├ù[31m should reconnect[39m[32m 7[2mms[22m[39m
[31m     [31m├ù[31m should cap reconnection delay[39m[32m 5[2mms[22m[39m
[31m     [31m├ù[31m should not throw on malformed JSON[39m[32m 6[2mms[22m[39m

[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m[1m[41m 
Failed Tests 7 
[49m[22m[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
connect and update state
[31m[1mAssertionError[22m: expected +0 
to be 1 // Object.is equality[39m

[32m- Expected[39m
[31m+ Received[39m

[32m- 1[39m
[31m+ 0[39m

[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m46:32[22m[39m
    [90m 44| [39m    client[33m.[39m[
34mconnect[39m()[33m;[39m
    [90m 45| [39m    [34mexpect[39m(on
StateChange)[33m.[39m[34mtoHaveBeenCall
edWith[39m([32m'connecting'[39m)[33m;
[39m
    [90m 46| [39m    [34mexpect[39m(mo
ckSockets[33m.[39mlength)[33m.[39m[34
mtoBe[39m([34m1[39m)[33m;[39m
    [90m   | [39m                       
        [31m^[39m
    [90m 47| [39m  })[33m;[39m
    [90m 48| [39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[1/
7]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
handle open
[31m[1mTypeError[22m: Cannot read 
properties of undefined (reading 
'onopen')[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m52:16[22m[39m
    [90m 50| [39m    client[33m.[39m[
34mconnect[39m()[33m;[39m
    [90m 51| [39m    [35mconst[39m 
socket [33m=[39m 
mockSockets[[34m0[39m][33m;[39m
    [90m 52| [39m    [35mif[39m 
(socket[33m.[39monopen) socket[33m.[39
m[34monopen[39m()[33m;[39m
    [90m   | [39m               
[31m^[39m
    [90m 53| [39m    [34mexpect[39m(on
StateChange)[33m.[39m[34mtoHaveBeenCall
edWith[39m([32m'connected'[39m)[33m;[
39m
    [90m 54| [39m  })[33m;[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[2/
7]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
send heartbeat
[31m[1mTypeError[22m: Cannot read 
properties of undefined (reading 
'onopen')[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m59:16[22m[39m
    [90m 57| [39m    client[33m.[39m[
34mconnect[39m()[33m;[39m
    [90m 58| [39m    [35mconst[39m 
socket [33m=[39m 
mockSockets[[34m0[39m][33m;[39m
    [90m 59| [39m    [35mif[39m 
(socket[33m.[39monopen) socket[33m.[39
m[34monopen[39m()[33m;[39m
    [90m   | [39m               
[31m^[39m
    [90m 60| [39m    
    [90m 61| [39m    vi[33m.[39m[34ma
dvanceTimersByTime[39m([34m30000[39m)[
33m;[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[3/
7]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
disconnect on pong timeout
[31m[1mTypeError[22m: Cannot read 
properties of undefined (reading 
'onopen')[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m68:16[22m[39m
    [90m 66| [39m    client[33m.[39m[
34mconnect[39m()[33m;[39m
    [90m 67| [39m    [35mconst[39m 
socket [33m=[39m 
mockSockets[[34m0[39m][33m;[39m
    [90m 68| [39m    [35mif[39m 
(socket[33m.[39monopen) socket[33m.[39
m[34monopen[39m()[33m;[39m
    [90m   | [39m               
[31m^[39m
    [90m 69| [39m    
    [90m 70| [39m    vi[33m.[39m[34ma
dvanceTimersByTime[39m([34m30000[39m)[
33m;[39m [90m// Send PING[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[4/
7]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
reconnect
[31m[1mTypeError[22m: Cannot read 
properties of undefined (reading 
'onopen')[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m80:17[22m[39m
    [90m 78| [39m    client[33m.[39m[
34mconnect[39m()[33m;[39m
    [90m 79| [39m    [35mconst[39m 
socket1 [33m=[39m 
mockSockets[[34m0[39m][33m;[39m
    [90m 80| [39m    [35mif[39m 
(socket1[33m.[39monopen) socket1[33m.[
39m[34monopen[39m()[33m;[39m
    [90m   | [39m                
[31m^[39m
    [90m 81| [39m    [35mif[39m 
(socket1[33m.[39monclose) socket1[33m.
[39m[34monclose[39m()[33m;[39m
    [90m 82| [39m    

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[5/
7]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
cap reconnection delay
[31m[1mTypeError[22m: Cannot read 
properties of undefined (reading 
'onclose')[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m94:28[22m[39m
    [90m 92| [39m    [90m// Simulate 
multiple failures[39m
    [90m 93| [39m    [35mfor[39m 
([35mlet[39m i [33m=[39m 
[34m0[39m[33m;[39m i [33m<[39m 
[34m5[39m[33m;[39m i[33m++[39m) {
    [90m 94| [39m        [35mif[39m 
(mockSockets[i][33m.[39monclose) mockSoc
kets[i][33m.[39m[34monclose[39m()[33m
;[39m
    [90m   | [39m                       
    [31m^[39m
    [90m 95| [39m        vi[33m.[39m[
34mrunOnlyPendingTimers[39m()[33m;[39m
    [90m 96| [39m    }

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[6/
7]ΓÄ»[22m[39m

[41m[1m FAIL [22m[49m 
src/test/unit/websocket.test.ts[2m > 
[22mWebSocketClient[2m > [22mshould 
not throw on malformed JSON
[31m[1mTypeError[22m: Cannot read 
properties of undefined (reading 
'onopen')[39m
[36m [2mΓ¥»[22m src/test/unit/websocket
.test.ts:[2m104:16[22m[39m
    [90m102| [39m    client[33m.[39m[
34mconnect[39m()[33m;[39m
    [90m103| [39m    [35mconst[39m 
socket [33m=[39m 
mockSockets[[34m0[39m][33m;[39m
    [90m104| [39m    [35mif[39m 
(socket[33m.[39monopen) socket[33m.[39
m[34monopen[39m()[33m;[39m
    [90m   | [39m               
[31m^[39m
    [90m105| [39m    
    [90m106| [39m    
[34mexpect[39m(() [33m=>[39m {

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»
ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[7/
7]ΓÄ»[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m7 failed[39m[22m[90m (7)[39m
[2m   Start at [22m 11:04:06
[2m   Duration [22m 1.16s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
